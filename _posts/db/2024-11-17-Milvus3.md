---
title: Insert data in Collection
description: Let's insert data in collection.
author: DS2Man
date: 2024-11-17 11:00:00 +0000
categories: [DB, Milvus]
tags:
  - DB
  - VectorDB
  - Milvus
math: true
pin: true
---

## *Prepare Sample Data*

| Date       | NewsPaper                  | Topic                     | News |
|------------|----------------------------|---------------------------|------|
| 2024-09-09 | MBC                         | 2024 US Open Victory      | Jannik Sinner (World No. 1, Italy) clinched the men's singles title at the US Open tennis tournament. |
| 2024-09-10 | Yonhap News                 | US Open Victory           | Jannik Sinner (World No. 1, Italy) clinched the men's singles title at the US Open tennis tournament. |
| 2024-08-03 | Dong-A Ilbo                 | Olympic Final             | Novak Djokovic and Carlos Alcaraz faced off in the men's singles final at the 2024 Paris Olympics. |
| 2024-08-02 | Newsis                      | Andy Murray's Retirement  | British tennis star Andy Murray concluded his professional career at the 2024 Paris Olympics, sharing a lighthearted retirement message. |
| 2024-07-03 | Official Olympics Website   | Wimbledon                 | Korea's Kwon Soon-woo was eliminated in the first round of Wimbledon 2024, losing to Denmark's Holger Rune. |
| 2024-11-13 | Chosun Ilbo                 | ATP Finals Victory        | Jannik Sinner dominated men's tennis in 2024, securing the ATP Finals title. |

```bash
import pandas as pd
import numpy as np

df = pd.read_excel('.\\Tennis_2024_news.xlsx', engine='openpyxl')
news = df['News'].tolist()

embedding_model = SentenceTransformer(f"./{MODEL_FOLDER}/{EMBED_MODEL}")
embedding = embedding_model.encode(news, normalize_embeddings=True)

df['News_embedding'] = df['News'].apply(lambda x: embedding_model.encode(x, normalize_embeddings=True).tolist())
extracted_data = df.to_dict(orient='records')
extracted_data[0]
```

```
{'Date': 20240909,
 'NewsPaper': 'MBC',
 'Topic': '2024 US Open Victory',
 'News': "Jannik Sinner (World No. 1, Italy) clinched the men's singles title at the US Open tennis tournament.",
 'News_embedding': [-0.026207489892840385,
  0.015767322853207588,
  -0.05157271400094032,
  ...]
```

## *Create Collection*

#### *Step1) Connect to MilvusClient*

```bash
from pymilvus import MilvusClient

client = MilvusClient(uri=MILVUS_URL)
client.using_database(MILVUS_DB_NAME)

# Insert data
insert_result = client.insert(MILVUS_COL_NAME, extracted_data)
print(f"Inserted count: {insert_result['insert_count']}")

# Note. Persist data into Milvus (Mandatory step)
client.flush(MILVUS_COL_NAME)

# Load collection (Required before search and query operations)
print("Milvus data preparation complete!")
```
